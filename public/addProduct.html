<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Admin Panel - Product Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f4f6f9;
            padding: 20px;
        }

        h1,
        h2 {
            color: #333;
            margin-bottom: 20px;
        }

        /* Form Card */
        .card {
            background: #fff;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 40px;
            max-width: 500px;
        }

        form input,
        form textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
        }

        form button {
            background: #4f46e5;
            color: #fff;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        form button:hover {
            background: #4338ca;
        }

        /* Table Styling */
        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        table th,
        table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
            font-size: 14px;
        }

        table th {
            background: #4f46e5;
            color: #fff;
            font-weight: 600;
        }

        table tr:hover {
            background: #f1f5f9;
        }

        table img {
            max-width: 80px;
            border-radius: 5px;
        }

        table button {
            background: #ef4444;
            color: #fff;
            border: none;
            padding: 6px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.3s;
        }

        table button:hover {
            background: #dc2626;
        }

        @media (min-width: 768px) {

            table th,
            table td {
                font-size: 12px;
                padding: 8px;
            }

            table img {
                max-width: 60px;
            }
        }
    </style>
</head>

<body>

    <div class="card">
        <h2>Add Product</h2>
        <form id="productForm">
            <input type="text" id="name" placeholder="Product Name" required>
            <input type="text" id="category" placeholder="Category" required>
            <textarea id="description" placeholder="Description" required></textarea>
            <input type="number" id="price" placeholder="Price" required>
            <input type="text" id="image" placeholder="Image name (example.jpg)" required>
            <input type="text" id="features" placeholder="Features (comma separated)">
            <button type="submit">Add Product</button>
        </form>
    </div>

    <h2>All Products</h2>
    <table id="products">
        <thead>
            <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Price</th>
                <th>Description</th>
                <th>Image</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        // Add Product
        document.getElementById("productForm").addEventListener("submit", function (e) {
            e.preventDefault();

            const product = {
                name: document.getElementById("name").value,
                category: document.getElementById("category").value,
                description: document.getElementById("description").value,
                price: Number(document.getElementById("price").value),
                image: "/Assets/Images/" + document.getElementById("image").value,
                features: document.getElementById("features").value
                    .split(",")
                    .map(f => f.trim())
            };

            fetch("/api/products", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(product)
            })
                .then(res => res.json())
                .then(() => {
                    alert("Product Added");
                    document.getElementById("productForm").reset();
                    loadProducts();
                });
        });

        // Load All Products
        function loadProducts() {
            fetch("/api/products")
                .then(res => res.json())
                .then(data => {
                    const tbody = document.querySelector("#products tbody");
                    tbody.innerHTML = "";

                    data.forEach(p => {
                        const tr = document.createElement("tr");

                        tr.innerHTML = `
              <td>${p.name}</td>
              <td>${p.category}</td>
              <td>$${p.price}</td>
              <td>${p.description}</td>
              <td><img src="${p.image}" alt="${p.name}"></td>
              <td><button onclick="deleteProduct('${p._id}')">Delete</button></td>
            `;

                        tbody.appendChild(tr);
                    });
                });
        }

        // Delete Product
        function deleteProduct(id) {
            if (!confirm("Are you sure you want to delete this product?")) return;

            fetch(`/api/products/${id}`, {
                method: "DELETE",
                headers: { "Content-Type": "application/json" }
            })
                .then(res => {
                    if (res.ok) {
                        alert("Product Deleted");
                        loadProducts();
                    } else {
                        alert("Error deleting product");
                    }
                })
                .catch(err => console.error(err));
        }

        // Load products on page load
        loadProducts();
    </script>

</body>

</html>